# PPO Financial Compliance Configuration based on NeMo-Aligner defaults
name: ppo_financial_compliance

trainer:
  devices: 8
  num_nodes: 1
  accelerator: gpu
  precision: bf16
  logger:
    name: ppo_financial_compliance
  max_steps: 1000

model:
  alignment:
    type: ppo
    # Paths to NeMo weights (placeholders for actual .nemo files)
    reward_model_path: "models/reward_model_v1.nemo"
    critic_model_path: "models/critic_v1.nemo"
    policy_model_path: "models/policy_v1.nemo"
    
    # RLHF Hyperparameters matching NeMo-Aligner PPO spec
    ppo:
      kl_coeff: 0.1
      ppo_epochs: 1
      batch_size: 64
      gamma: 1.0
      lam: 0.95
      cliprange: 0.2
      cliprange_value: 0.2
      vf_coef: 0.1

  data:
    train_ds:
      file_path: "data/preference_pairs.jsonl"
      max_seq_length: 2048
      batch_size: 16
      shuffle: True
      num_workers: 4
    validation_ds:
      file_path: "data/validation_pairs.jsonl"
      max_seq_length: 2048
      batch_size: 16
      shuffle: False

  optim:
    name: distributed_fused_adam
    lr: 1e-6
    weight_decay: 0.01
    sched:
      name: CosineAnnealing
      warmup_steps: 100
      min_lr: 1e-7
